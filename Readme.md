<h1> Онлайн транскрипция аудио и видео </h1>

<p align="left">
  <a href="https://github.com/svyatoslav-rozhdestvenskiy">
    <img alt="Static Badge" src="https://img.shields.io/badge/audio_transcription-%23000000?style=plastic&label=svyatoslav-rozhdestvenskiy&labelColor=%23008000">
  </a>
  <img alt="GitHub top language" src="https://img.shields.io/github/languages/top/svyatoslav-rozhdestvenskiy/audio_transcription_streamlit?style=plastic&logoColor=008000&labelColor=008000&color=000000">
  <img alt="GitHub repo size" src="https://img.shields.io/github/repo-size/svyatoslav-rozhdestvenskiy/audio_transcription_streamlit?style=plastic&labelColor=008000&color=000000">

## Постановка задачи

Необходимо создать тестовый стенд для API по распознаванию речи. Стенд состоит из источника аудио и потребителя аудио.

Сервис потребитель аудио принимает bytes аудиопотока и транскрибирует речь, сохраняя ее в файл. Реализация на усмотрение соискателя. Требуется обеспечить единовременную транскрибацию, как минимум, 3-х аудио-потоков. Необходимо переиспользовать уже инстанцированную модель, а не создавать новую при каждом запросе.

Источник аудио представляет собой скрипт читающий аудио файл , открывающий соединение по RPC или Web Socket и отправляющий в канал содержимое файла (bytes) пакетами по 1000 фреймов.

Код должен быть организован в соответствиями с требованиями архитектуры, используя ООП парадигму.

Желательно создать временный фронтэнд с использованием средств прототипирования, например, библиотека Streamlit.

Желательно упаковать решение в Docker



## Сайт

На сайте можно загружать аудио и видеофайлы в любом формате.

![Загрузка файлов](data/1.png)

Файлы хранятся до перезапуска программы.

Через некоторое время сервер извлечёт речь, и результаты появятся в таблице.


![Результаты обработки](data/3.png)

Можно отправлять на обработку до 10 файлов за раз.(Можно увеличить)
Если лимит превышен, появится статус **"Сервер перегружен, попробуйте позже"**.


![Перегрузка сервера](data/4.png)

Чтобы узнать актуальный статус обработки файлов, нужно:
- Перезагрузить страницу
- Нажать кнопку - "Обновить результаты"


## Описание работы приложения

### Архитектура

Приложение состоит из двух отдельных сервисов:

- Бэкенд (WebSocket) – принимает аудиофайлы, выполняет транскрипцию и отправляет результат.
- Фронтенд (Streamlit + WebSocket) – принимает файлы, передаёт их на сервер и отображает результаты.


### Как работает бэкенд?

Бэкенд — это сервер, который принимает аудиофайлы и выполняет транскрипцию через Whisper (по возможности с использованием видеокарты).

1. Ожидает WebSocket-соединения
   - Фронтенд устанавливает соединение и передаёт файл пакетами по 1000 фреймов.
    - Формируется асинхронная очередь задач (не более 10 активных задач одновременно).

2. Обрабатывает аудио

   - Преобразует файл в wav (если требуется).
   - Выполняет предобработку аудиозаписи.
   - Распознаёт текст с помощью Whisper.

3. Возвращает результат через WebSocket на Фронтэнд-сервер
   - Отправляет готовую транскрипцию или информацию об ошибке.



### Как работает фронтенд?

Фронтенд — это сайт Streamlit и сервер, который управляет задачами.

1. Сайт позволяет загружать файлы
   - Проверяет корректность формата.
   - Передаёт файл на Бэкенд-сервер по WebSocket пакетами по 1000 фреймов.

2. Фронтенд-сервер обрабатывает ответы от бэкенда
   - Слушает ответы от WebSocket-сервера бэкенда.
   - Обновляет статусы файлов в интерфейсе.

3. Обновление информации
   - Пользователь видит статус обработки каждого файла.
   - Чтобы получить актуальные данные, можно перезагрузить страницу или нажать кнопку "Обновить результаты".

## Локальный запуск

1. Клонируйте репозиторий

```bash
git clone https://github.com/svyatoslav-rozhdestvenskiy/audio_transcription_streamlit.git
```

2. Установите зависимости

```bash
pip install -r requirements.txt
```

3. Запустите бэкенд

```bash
cd backend
python main.py
```

4. Запустите фронтэнд

```bash
cd ..
cd frontend
python main.py
```

5. Перейдите на сайт и протестируйте

```bash
http://localhost:8501
```
